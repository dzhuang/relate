{% extends "image_upload/upload-form.html" %}
{% load i18n %}

{% block UPLOAD_FORM_BUTTON_BAR %}
    {% if IN_GRADE_PAGE %}
    {% elif MAY_CHANGE_ANSWER or IS_COURSE_STAFF %}
        {{ block.super }}
    {% endif %}
{% endblock %}

{% block JS_DOWNLOAD_TEMPLATE_PREVIEW %}
    <td
            {% if not IN_GRADE_PAGE %}
                class="col-lg-2 col-sm-3 col-xs-3"
            {% endif %}
    >
        <span class="preview processing">
            {{ JQ_OPEN }} if (file.thumbnailUrl) { {{ JQ_CLOSE }}
                <a
                        href="{{ JQ_OPEN }}=file.url{{ JQ_CLOSE }}"
                        title="{{ JQ_OPEN }}=file.name{{ JQ_CLOSE }}"
                        download="{{ JQ_OPEN }}=file.name{{ JQ_CLOSE }}"
                        data-gallery>
                        <img class="img-responsive"
                                {% if IN_GRADE_PAGE %}
                             src="{{ JQ_OPEN }}=file.url{{ JQ_CLOSE }}"
                             onmouseover="magnify(this)"
                             data-zoom-image="{{ JQ_OPEN }}=file.url{{ JQ_CLOSE }}"
                                {% else %}
                             src="{{ JQ_OPEN }}=file.thumbnailUrl{{ JQ_CLOSE }}"
                                {% endif %}
                        >
                </a>
            {{ JQ_OPEN }} } {{ JQ_CLOSE }}
        </span>
    </td>
{% endblock %}{# //JS_DOWNLOAD_TEMPLATE_PREVIEW #}

{% block JS_DOWNLOAD_TEMPLATE_DOWNLOAD %}
    {% if not IN_GRADE_PAGE %}
        {{ block.super }}
    {% endif %}
{% endblock %}

{% block JS_DOWNLOAD_TEMPLATE_EXTRA_INFO_COLUMN %}
    {% if SHOW_CREATION_TIME and not IN_GRADE_PAGE %}
        <td class="col-lg-3 hidden-sm hidden-xs td-dl grading-hidden">
            <span
                    class="timestr"
                    id="filetime{{ JQ_OPEN }}=file.pk{{ JQ_CLOSE }}"
                    title="{{ JQ_OPEN }}=file.timestr_title{{ JQ_CLOSE }}"
            >
                {{ JQ_OPEN }}=file.timestr_short{{ JQ_CLOSE }}
            </span>
        </td>
    {% endif %}
{% endblock %}{# //JS_DOWNLOAD_TEMPLATE_EXTRA_INFO_COLUMN #}


{% block JS_DOWNLOAD_TEMPLATE_FSIZE %}
    {% if not IN_GRADE_PAGE %}
        {{ block.super }}
    {% endif %}
{% endblock %}{# //JS_DOWNLOAD_TEMPLATE_FSIZE #}

{% block JS_DOWNLOAD_TEMPLATE_CONTROL_BUTTONS %}
    <td
            {% if not IN_GRADE_PAGE %}
                class="col-lg-3 col-sm-4 col-xs-4"
            {% else %}
            {% endif %}
    >
    {% if IS_COURSE_STAFF or MAY_CHANGE_ANSWER %}
        {% block COPY_IMAGE_DATA %}
            {% if IS_COURSE_STAFF and SHOW_COPY_IMAGE_DATA %}
                {# 只有在设计问题时才有用 #}
                {{ JQ_OPEN }} if (file.image_data_dict) { {{ JQ_CLOSE }}
                <a class="btn-data-copy"
                   data-clipboard-text="{{ JQ_OPEN }}=file.image_data_dict{{ JQ_CLOSE }}"
                >
                    <i class="fa fa-clipboard" aria-hidden="true"></i></a>
                {{ JQ_OPEN }} } {{ JQ_CLOSE }}
                {{ JQ_OPEN }} if (file.imageAdminUrl) { {{ JQ_CLOSE }}
                <a
                        href={{ JQ_OPEN }}=file.imageAdminUrl{{ JQ_CLOSE }}
                        target='_blank'
                >
                    <i class="fa fa-user"></i></a>
                {{ JQ_OPEN }} } {{ JQ_CLOSE }}
            {% endif %}
        {% endblock %}{# //COPY_IMAGE_DATA #}
        <button
                class="btn btn-success btn-edit-image btn-control"
                type="button"
                data-toggle="modal"
                data-action="{{ JQ_OPEN }}=file.crop_handler_url{{ JQ_CLOSE }}"
                data-src="{{ JQ_OPEN }}=file.url{{ JQ_CLOSE }}"
                data-pk="{{ JQ_OPEN }}=file.pk{{ JQ_CLOSE }}"
                data-data="{{ csrf_token }}"
                data-target="#editPopup"
                {% if IN_GRADE_PAGE %}
                    style="z-index: 5000;"
                {% endif %}
        >
            <i class="fa fa-pencil"></i>
            {% if not IN_GRADE_PAGE %}
                <span>{% trans "Edit" %}</span>
            {% endif %}
        </button>
    {% endif %}
    {% block JS_DOWNLOAD_TEMPLATE_CONTROL_BUTTONS_DELETE %}
        {% if IN_GRADE_PAGE %}
        {% elif IS_COURSE_STAFF or MAY_CHANGE_ANSWER %}
            {{ block.super }}
        {% endif %}
    {% endblock %}
{% endblock %}{# // JS_DOWNLOAD_TEMPLATE_CONTROL_BUTTONS #}

{% block JS_DOWNLOAD_TEMPLATE_EXTRA_COLUMN %}
    {% if IS_COURSE_STAFF or MAY_CHANGE_ANSWER %}
        <td class="imageSortableHandle hidden
        {% if not IN_GRADE_PAGE %}
            col-lg-2 col-sm-1 col-xs-1
         {% endif %}"
             style="vertical-align: middle;"
            >
                <span title="{% trans 'Drag to order' %}">
                    <i class="fa fa-sort fa-3" aria-hidden="true"></i>
                </span>
        </td>
    {% endif %}
{% endblock %}{# //JS_DOWNLOAD_TEMPLATE_EXTRA_COLUMN #}

